<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - Events Controls</title>
		<meta charset="utf-8">
		<style>
			body {
				margin: 0px;
				color: #fff;
				font-family:Monospace;
				text-align: center;
				font-size: 15px;
				line-height: 30px;
				overflow: hidden;
			}
			#info {
				position: absolute;
				top: 0px; width: 100%;
				padding: 5px;
				z-index:0;
			}		
			
		</style>
	</head>
	<body>
		<div id="info">
			<a href="http://threejs.org" target="_blank">three.js</a> EventsControls (look console)
		</div>

		<script src="../build/three.min.js"></script>

		<script src="js/libs/stats.min.js"></script>
	
		<script src="js/controls/EventsControls.js"></script>

		<script>


			var camera, scene, renderer, controls;
				var vectors = [];
			
			
			init();
			animate();

			function init() {

				renderer = new THREE.WebGLRenderer( { antialias: true } ); 
				renderer.setClearColor( 0x6495ED );
				renderer.setSize( window.innerWidth, window.innerHeight );				
				document.body.appendChild( renderer.domElement );

				//

				stats = new Stats();
				stats.domElement.style.position = 'absolute';
				stats.domElement.style.top = '0px';
				stats.domElement.style.zIndex = 100;
				document.body.appendChild( stats.domElement );

				//

				var showResult = document.createElement('div');
				showResult.style.position = 'absolute';
				showResult.style.top = '100px';
				showResult.style.width = '300px';
				showResult.style.fontSize = '16px';
				showResult.style.zIndex = 101;
				showResult.innerHTML = 'Кликните для получения результата!';
				showResult.addEventListener("click", function(){
					var sssr = "", st = "";
					for ( var i = 0; i < vectors.length; i++ ) {

						st = 'vectors[' + i + '] = new THREE.Vector3(' + EventsControls.objects[i].position.x + ',' +
							EventsControls.objects[i].position.y + ',' + EventsControls.objects[i].position.z + ');\n';
						sssr = sssr + st;
					}		
					
					//showResult.innerHTML = sssr;
					console.log( sssr );
					
				});
				
				document.body.appendChild( showResult );				
				//
				
				camera = new THREE.PerspectiveCamera( 30, window.innerWidth / window.innerHeight, 1, 2000 );
				camera.position.set( 0, 0, 1000 );
				camera.lookAt( new THREE.Vector3( 0, 0, 0 ) );

				scene = new THREE.Scene();

				var light = new THREE.DirectionalLight( 0xffffff, 1 );
				light.position.set( 0, 500, 1000 );
				scene.add( light );

				var light = new THREE.AmbientLight( 0x222222 );
				scene.add( light );


				// world
				
				var Texture = new THREE.ImageUtils.loadTexture( 'textures/brightlake.png' );
				Texture.wrapS = Texture.wrapT = THREE.RepeatWrapping;

				var Material = new THREE.MeshBasicMaterial( { map: Texture, side: THREE.DoubleSide } );
				var Geometry = new THREE.PlaneGeometry( 512, 512, 1, 1 );

				var checkerboard = new THREE.Mesh( Geometry, Material );
				scene.add( checkerboard );


				EventsControls = new EventsControls( camera, renderer.domElement );
				EventsControls.map = checkerboard;
				EventsControls.attachEvent( 'mouseOver', function () {

					this.container.style.cursor = 'pointer';
					console.log( 'the key at number ' + this.event.item + ' is select' );


				});

				EventsControls.attachEvent( 'mouseOut', function () {

					this.container.style.cursor = 'auto';

				});

				EventsControls.attachEvent( 'dragAndDrop', function () {

					this.container.style.cursor = 'move';
					this.focused.position.x = Math.round( ( this.focused.position.x ) );
					this.focused.position.y = Math.round( ( this.focused.position.y ) );
					

				});

				EventsControls.attachEvent( 'mouseUp', function () {

					this.container.style.cursor = 'auto';

				});


				vectors[0] = new THREE.Vector3(247,-101,0);
				vectors[1] = new THREE.Vector3(200,-70,0);
				vectors[2] = new THREE.Vector3(148,-35,0);
				vectors[3] = new THREE.Vector3(103,2,0);
				vectors[4] = new THREE.Vector3(65,33,0);
				vectors[5] = new THREE.Vector3(26,55,0);
				vectors[6] = new THREE.Vector3(-10,73,0);
				vectors[7] = new THREE.Vector3(-51,103,0);
				vectors[8] = new THREE.Vector3(-69,145,0);
				vectors[9] = new THREE.Vector3(-60,188,0);
				vectors[10] = new THREE.Vector3(-87,203,0);
				vectors[11] = new THREE.Vector3(-148,213,0);
				vectors[12] = new THREE.Vector3(-181,186,0);
				vectors[13] = new THREE.Vector3(-215,145,0);
				vectors[14] = new THREE.Vector3(-238,110,0);
				vectors[15] = new THREE.Vector3(-240,66,0);
				vectors[16] = new THREE.Vector3(-235,17,0);
				vectors[17] = new THREE.Vector3(-223,-18,0);
				vectors[18] = new THREE.Vector3(-192,-51,0);
				vectors[19] = new THREE.Vector3(-127,-87,0);
				vectors[20] = new THREE.Vector3(-52,-91,0);
				vectors[21] = new THREE.Vector3(-20,-94,0);
				vectors[22] = new THREE.Vector3(21,-108,0);
				vectors[23] = new THREE.Vector3(54,-124,0);
				vectors[24] = new THREE.Vector3(87,-156,0);
				vectors[25] = new THREE.Vector3(119,-187,0);
				vectors[26] = new THREE.Vector3(149,-213,0);
				vectors[27] = new THREE.Vector3(186,-214,0);
				vectors[28] = new THREE.Vector3(203,-201,0);
				vectors[29] = new THREE.Vector3(224,-155,0);			
				
				//for ( var i = 0; i < 30; i++ ) {
				//	vectors[i] = new THREE.Vector3(  i * 10-100, -200, 0 ); 
				//}				
				
				var Circmaterial = new THREE.MeshBasicMaterial( {color: 0x00000f} );
				var Circgeometry = new THREE.CircleGeometry(4, 32 );	


				for ( var i = 0; i < vectors.length; i++ ) {

					var krugok = new THREE.Mesh(Circgeometry, Circmaterial);
					krugok.position.copy( vectors[i] );
					scene.add( krugok ); 
					EventsControls.attach( krugok );

				}
					var sssr = "", st = "";
					for ( var i = 0; i < vectors.length; i++ ) {

						st = 'vectors[' + i + '] = new THREE.Vector3(' + EventsControls.objects[i].position.x + ',' +
							EventsControls.objects[i].position.y + ');\n';
							sssr = sssr + st;
					}
				console.log('------------------------------------');				
				console.log(sssr);
				
				//

				window.addEventListener( 'resize', onWindowResize, false );


			}

			function onWindowResize() {
			
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );

			}


			function animate() {

					requestAnimationFrame(animate);
					render();

			}


			function render() {

					stats.update();

					EventsControls.update();
					renderer.render(scene, camera);

			}

		</script>

	</body>
</html>
